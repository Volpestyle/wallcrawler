<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WallCrawler Agent Portal</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE2IDBDOS4zNzI1OCAwIDQgNS4zNzI1OCA0IDEyQzQgMTguNjI3NCA5LjM3MjU4IDI0IDE2IDI0QzIyLjYyNzQgMjQgMjggMTguNjI3NCAyOCAxMkMyOCA1LjM3MjU4IDIyLjYyNzQgMCAxNiAwWiIgZmlsbD0iIzMzNzNkYyIvPgo8L3N2Zz4K">
</head>
<body>
    <div id="app">
        <!-- Loading state -->
        <div id="loading" class="loading-container">
            <div class="loading-spinner"></div>
            <div class="loading-text">Connecting to WallCrawler Agent...</div>
        </div>

        <!-- Main portal interface -->
        <div id="portal" class="portal-container" style="display: none;">
            <!-- Header -->
            <header class="portal-header">
                <div class="portal-title">
                    <h1>üï∑Ô∏è WallCrawler Agent Portal</h1>
                    <div class="session-info">
                        <span id="session-id">Session: Loading...</span>
                        <span id="connection-status" class="status-indicator connecting">Connecting</span>
                    </div>
                </div>
                
                <div class="portal-controls">
                    <button id="pause-btn" class="control-btn pause" title="Pause Automation">
                        <span class="btn-icon">‚è∏Ô∏è</span>
                        <span class="btn-text">Pause</span>
                    </button>
                    <button id="resume-btn" class="control-btn resume" title="Resume Automation">
                        <span class="btn-icon">‚ñ∂Ô∏è</span>
                        <span class="btn-text">Resume</span>
                    </button>
                    <button id="take-control-btn" class="control-btn take-control" title="Take Manual Control">
                        <span class="btn-icon">üéÆ</span>
                        <span class="btn-text">Take Control</span>
                    </button>
                    <button id="screenshot-btn" class="control-btn screenshot" title="Take Screenshot">
                        <span class="btn-icon">üì∏</span>
                        <span class="btn-text">Screenshot</span>
                    </button>
                    <button id="close-btn" class="control-btn close" title="Close Portal">
                        <span class="btn-icon">‚úï</span>
                        <span class="btn-text">Close</span>
                    </button>
                </div>
            </header>

            <!-- Main content area -->
            <main class="portal-main">
                <!-- Browser viewer -->
                <section class="browser-section">
                    <div class="browser-header">
                        <div class="browser-info">
                            <span id="current-url">about:blank</span>
                            <span id="page-title">Loading...</span>
                        </div>
                        <div class="browser-controls">
                            <button id="reload-btn" class="browser-btn" title="Reload Page">üîÑ</button>
                            <button id="fullscreen-btn" class="browser-btn" title="Fullscreen">‚õ∂</button>
                        </div>
                    </div>
                    <div id="browser-viewer" class="browser-viewer">
                        <div class="no-content">
                            <div class="no-content-icon">üï∑Ô∏è</div>
                            <div class="no-content-text">Waiting for browser content...</div>
                        </div>
                    </div>
                </section>

                <!-- Sidebar -->
                <aside class="portal-sidebar">
                    <!-- Automation status -->
                    <section class="sidebar-section">
                        <h3>Automation Status</h3>
                        <div class="status-card">
                            <div class="status-item">
                                <span class="status-label">Status:</span>
                                <span id="automation-status" class="status-value">Unknown</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">Last Action:</span>
                                <span id="last-action" class="status-value">None</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">Duration:</span>
                                <span id="session-duration" class="status-value">00:00:00</span>
                            </div>
                        </div>
                    </section>

                    <!-- Action History -->
                    <section class="sidebar-section">
                        <h3>Action History</h3>
                        <div id="action-history" class="action-history">
                            <div class="no-actions">No actions yet</div>
                        </div>
                    </section>

                    <!-- Element Inspector -->
                    <section class="sidebar-section">
                        <h3>Element Inspector</h3>
                        <div id="element-inspector" class="element-inspector">
                            <div class="no-selection">Click on an element to inspect</div>
                        </div>
                    </section>

                    <!-- Manual Controls -->
                    <section class="sidebar-section">
                        <h3>Manual Actions</h3>
                        <div class="manual-controls">
                            <div class="control-group">
                                <label for="manual-action-type">Action Type:</label>
                                <select id="manual-action-type">
                                    <option value="click">Click</option>
                                    <option value="type">Type Text</option>
                                    <option value="select">Select Option</option>
                                    <option value="scroll">Scroll</option>
                                </select>
                            </div>
                            <div class="control-group">
                                <label for="manual-selector">Element Selector:</label>
                                <input type="text" id="manual-selector" placeholder="CSS selector or use inspector">
                            </div>
                            <div class="control-group">
                                <label for="manual-value">Value (if needed):</label>
                                <input type="text" id="manual-value" placeholder="Text to type, option to select, etc.">
                            </div>
                            <button id="execute-manual-action" class="execute-btn">Execute Action</button>
                        </div>
                    </section>
                </aside>
            </main>

            <!-- Status bar -->
            <footer class="portal-footer">
                <div class="status-info">
                    <span id="connection-info">Disconnected</span>
                    <span id="latency-info">Latency: --ms</span>
                    <span id="messages-info">Messages: 0</span>
                </div>
                <div class="portal-version">
                    WallCrawler Portal v1.0.0
                </div>
            </footer>
        </div>

        <!-- Error state -->
        <div id="error" class="error-container" style="display: none;">
            <div class="error-icon">‚ö†Ô∏è</div>
            <h2>Connection Error</h2>
            <p id="error-message">Failed to connect to the WallCrawler agent.</p>
            <button id="retry-btn" class="retry-btn">Retry Connection</button>
        </div>
    </div>

    <!-- Context menu -->
    <div id="context-menu" class="context-menu" style="display: none;">
        <div class="menu-item" data-action="click">Click Element</div>
        <div class="menu-item" data-action="inspect">Inspect Element</div>
        <div class="menu-item" data-action="copy-selector">Copy Selector</div>
        <div class="menu-separator"></div>
        <div class="menu-item" data-action="screenshot">Screenshot</div>
    </div>

    <!-- Modals -->
    <div id="modal-overlay" class="modal-overlay" style="display: none;">
        <div id="screenshot-modal" class="modal">
            <div class="modal-header">
                <h3>Screenshot</h3>
                <button class="modal-close">‚úï</button>
            </div>
            <div class="modal-body">
                <img id="screenshot-image" src="" alt="Screenshot">
            </div>
            <div class="modal-footer">
                <button id="download-screenshot" class="btn btn-primary">Download</button>
                <button class="modal-close btn btn-secondary">Close</button>
            </div>
        </div>
    </div>

    <script type="module" src="portal-app.js"></script>
</body>
</html>